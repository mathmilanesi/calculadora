<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de Pre√ßos</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    body {
      background-color: #121212;
      color: #fff;
      padding-top: 100px;
    }

    .container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .card {
      background-color: #1e1e1e;
      border: none;
      padding: 20px;
      border-radius: 10px;
      color: #fff;
      min-width: 320px;
      width: 100%;
      max-width: 400px;
    }

    .form-control {
      background-color: #333;
      border: none;
      color: #fff;
      margin-bottom: 10px;
    }

    .input-group-text {
      background-color: #444;
      border: none;
      color: #fff;
      cursor: pointer;
      padding: 0.25rem 0.4rem;
      font-size: 0.7rem;
      width: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-custom {
      background-color: #28a745;
      color: white;
      width: 100%;
      font-size: 0.9em;
      padding: 7px;
    }
    
    .btn-ingressos {
      background-color: #6f42c1;
      color: white;
      width: 100%;
      font-size: 0.9em;
      padding: 7px;
    }

    .btn-custom:hover {
      background-color: #218838;
    }
    
    .btn-ingressos:hover {
      background-color: #5a32a3;
    }

    .titulo {
      font-size: 1.5em;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .form-check-label {
      font-size: 1.1em;
      margin-left: 5px;
    }

    .form-check-input {
      transform: scale(1.5);
      margin-right: 10px;
    }

    #infoParceria {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #0dcaf0;
      color: #000;
      padding: 15px 25px;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: 500;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 9999;
      display: none;
      opacity: 0;
      transition: opacity 0.5s ease-in-out;
    }

    #infoParceria.show {
      display: block;
      opacity: 1;
    }

    .log-container {
      max-height: 400px;
      overflow-y: auto;
    }

    /* Modal personalizado para o tema escuro */
    .modal-content {
      background-color: #1e1e1e;
      color: white;
    }

    .modal-header {
      border-bottom: 1px solid #333;
    }

    .modal-title {
      color: white;
    }

    .modal-footer button {
      color: white;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        align-items: center;
      }

      .titulo {
        font-size: 1.3em;
      }
    }
  </style>
</head>
<body>
  <!-- Notifica√ß√£o visual melhorada -->
  <div id="infoParceria" class="text-center">
    <!-- Conte√∫do ser√° inserido via JavaScript -->
  </div>

  <div class="container">
    <!-- Calculadora -->
    <div class="card p-4">
      <h4 class="titulo"><i class="fas fa-shopping-cart"></i> Calculadora de Pre√ßos</h4>
      <div class="mt-3">
        <label>üõ°Ô∏è Colete</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="colete" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('colete').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('colete').value = parseInt(document.getElementById('colete').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
        
        <label>üí£ C4</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="c4" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('c4').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('c4').value = parseInt(document.getElementById('c4').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
        
        <label>üîó Algema</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="algema" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('algema').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('algema').value = parseInt(document.getElementById('algema').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
        
        <label>üé≠ Capuz</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="capuz" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('capuz').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('capuz').value = parseInt(document.getElementById('capuz').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
        
        <label>ü§ê Morda√ßa</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="mordaca" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('mordaca').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('mordaca').value = parseInt(document.getElementById('mordaca').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
        
        <label>üéó Corda</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="corda" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('corda').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('corda').value = parseInt(document.getElementById('corda').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
        
        <label>üìü Tablet</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="tablet" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('tablet').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('tablet').value = parseInt(document.getElementById('tablet').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
      </div>
      <button class="btn btn-custom mt-3" onclick="calcularTotal()">Calcular Total</button>

      <!-- Checkbox com destaque -->
      <div class="form-check mt-3">
        <input class="form-check-input" type="checkbox" id="parceriaToggle" />
        <label class="form-check-label" for="parceriaToggle">Com Parceria?</label>
      </div>

      <h5 class="mt-3 text-center" id="total">Total: R$0,00</h5>
      <h6 class="mt-2 text-center text-success" id="valorVendedor">Vendedor Recebe (30%): R$0,00</h6>
    </div>

    <!-- Calculadora de Ingressos -->
    <div class="card p-4">
      <h4 class="titulo"><i class="fas fa-ticket-alt"></i> Calculadora de Ingressos</h4>
      <div class="mt-3">
        <label>üë® Homens (R$5.000,00 cada)</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="homens" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('homens').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('homens').value = parseInt(document.getElementById('homens').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
        
        <label>üë© Mulheres (R$3.500,00 cada)</label>
        <div class="input-group mb-3">
          <input type="number" class="form-control" id="mulheres" value="0" min="0" />
          <span class="input-group-text" onclick="document.getElementById('mulheres').value = '0'">
            <i class="fas fa-times"></i>
          </span>
          <span class="input-group-text" onclick="document.getElementById('mulheres').value = parseInt(document.getElementById('mulheres').value || 0) + 1">
            <i class="fas fa-plus"></i>
          </span>
        </div>
      </div>
      <button class="btn btn-ingressos mt-3" onclick="calcularIngressos()">Calcular Ingressos</button>
      
      <h5 class="mt-3 text-center" id="totalIngressos">Total Ingressos: R$0,00</h5>
      <h6 class="mt-2 text-center text-info">Valor integral para a organiza√ß√£o</h6>
    </div>

    <!-- Tabela de Pre√ßos -->
    <div class="card p-4">
      <h4 class="titulo"><i class="fas fa-chart-bar"></i> Tabela de Pre√ßos</h4>
      <table class="table table-dark table-striped text-center">
        <thead>
          <tr>
            <th>Produto</th>
            <th>Sem Parceria</th>
            <th>Com Parceria</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>üõ°Ô∏è Colete</td><td>R$3.500,00</td><td>R$3.000,00</td></tr>
          <tr><td>üí£ C4</td><td>R$4.500,00</td><td>R$4.000,00</td></tr>
          <tr><td>üîó Algema</td><td>R$3.500,00</td><td>R$3.000,00</td></tr>
          <tr><td>üé≠ Capuz</td><td>R$3.500,00</td><td>R$3.000,00</td></tr>
          <tr><td>ü§ê Morda√ßa</td><td>R$6.000,00</td><td>R$5.000,00</td></tr>
          <tr><td>üéó Corda</td><td>R$6.000,00</td><td>R$5.000,00</td></tr>
          <tr><td>üìü Tablet</td><td>R$9.000,00</td><td>R$8.000,00</td></tr>
          <tr><td>üéüÔ∏è Ingresso Homem</td><td colspan="2">R$5.000,00</td></tr>
          <tr><td>üéüÔ∏è Ingresso Mulher</td><td colspan="2">R$3.500,00</td></tr>
        </tbody>
      </table>
    </div>

    <!-- Log de Vendas -->
    <div class="card p-4 mt-4">
      <h4 class="titulo"><i class="fas fa-file-invoice"></i> Log de Vendas</h4>
      <div class="log-container">
        <table class="table table-dark table-striped text-center">
          <thead>
            <tr>
              <th>Data / Hora</th>
              <th>Total</th>
              <th>Destino</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody id="logVendas">
            <!-- As vendas ser√£o listadas aqui -->
          </tbody>
        </table>
      </div>
      <div class="d-flex gap-2">
        <button class="btn btn-danger mt-3 flex-grow-1" onclick="confirmarLimpeza()">Limpar Logs</button>
        <button class="btn btn-primary mt-3 flex-grow-1" onclick="exportarXMLSemanal()">Exportar Semanal (XML)</button>
      </div>
    </div>
  </div>

  <!-- Modal de confirma√ß√£o de exclus√£o -->
  <div class="modal fade" id="modalConfirmacaoLimpeza" tabindex="-1" aria-labelledby="modalConfirmacaoLimpezaLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalConfirmacaoLimpezaLabel">Confirmar Limpeza de Logs</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body">
          Voc√™ tem certeza que deseja limpar todos os logs de vendas?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-danger" onclick="limparLogs()">Confirmar</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener("contextmenu", (event) => event.preventDefault());
    document.addEventListener("keydown", (event) => {
      if (
        event.key === "F12" ||
        (event.ctrlKey && event.shiftKey && event.key === "I") ||
        (event.ctrlKey && event.key === "U")
      ) {
        event.preventDefault();
      }
    });

    // Fun√ß√£o para carregar logs ao carregar a p√°gina
    window.onload = () => {
      const logs = localStorage.getItem("logs") ? JSON.parse(localStorage.getItem("logs")) : [];
      logs.forEach(addLog);
    };

    function calcularTotal() {
      // Verificar se todos os campos est√£o zerados
      let todosZerados = true;
      const campos = ['colete', 'c4', 'algema', 'capuz', 'mordaca', 'corda', 'tablet'];
      
      for (let campo of campos) {
        if (parseInt(document.getElementById(campo).value) > 0) {
          todosZerados = false;
          break;
        }
      }

      if (todosZerados) {
        alert("N√£o √© poss√≠vel calcular: nenhum item foi adicionado!");
        return;
      }

      let a = document.getElementById("parceriaToggle").checked,
        b = {
          colete: a ? 3000 : 3500,
          c4: a ? 4000 : 4500,
          algema: a ? 3000 : 3500,
          capuz: a ? 3000 : 3500,
          mordaca: a ? 5000 : 6000,
          corda: a ? 5000 : 6000,
          tablet: a ? 8000 : 9000,
        },
        c = 0;
      for (let d in b) {
        let e = parseInt(document.getElementById(d).value) || 0;
        c += e * b[d];
      }
      document.getElementById("total").innerText = "Total: R$" + c.toLocaleString("pt-BR", { minimumFractionDigits: 2 });

      let vendedorRecebe = c * 0.30;
      document.getElementById("valorVendedor").innerText = "Vendedor Recebe (30%): R$" + vendedorRecebe.toLocaleString("pt-BR", { minimumFractionDigits: 2 });

      // Mostrar a notifica√ß√£o tempor√°ria
      showInfoNotification(c, vendedorRecebe);

      // Salvar log
      salvarLog();
    }
    
    function calcularIngressos() {
      const homens = parseInt(document.getElementById("homens").value) || 0;
      const mulheres = parseInt(document.getElementById("mulheres").value) || 0;
      
      if (homens === 0 && mulheres === 0) {
        alert("N√£o √© poss√≠vel calcular: nenhum ingresso foi adicionado!");
        return;
      }
      
      const total = (homens * 5000) + (mulheres * 3500);
      document.getElementById("totalIngressos").innerText = "Total Ingressos: R$" + total.toLocaleString("pt-BR", { minimumFractionDigits: 2 });
      
      // Mostrar notifica√ß√£o
      showInfoNotification(total, 0, true);
      
      // Salvar log de ingressos
      salvarLogIngressos(total, homens, mulheres);
    }

    function showInfoNotification(valor, valor30, isIngresso = false) {
      const infoBox = document.getElementById("infoParceria");
      let valorFormatado = valor.toLocaleString("pt-BR", { minimumFractionDigits: 2 });
      
      if (isIngresso) {
        infoBox.innerText = `Total Ingressos: R$${valorFormatado}`;
        infoBox.style.backgroundColor = "#6f42c1";
      } else {
        let valor30Formatado = valor30.toLocaleString("pt-BR", { minimumFractionDigits: 2 });
        infoBox.innerText = `Total: R$${valorFormatado} | Vendedor Recebe (30%): R$${valor30Formatado}`;
        infoBox.style.backgroundColor = "#0dcaf0";
      }
      
      infoBox.classList.add("show");
      setTimeout(() => infoBox.classList.remove("show"), 5000);
    }

    function addLog(log) {
      const table = document.getElementById("logVendas");
      const row = table.insertRow(0);
      const dataHoraCell = row.insertCell(0);
      const totalCell = row.insertCell(1);
      const destinoCell = row.insertCell(2);
      const statusCell = row.insertCell(3);

      dataHoraCell.textContent = log.dataHora;
      totalCell.textContent = log.total;
      destinoCell.textContent = log.destino;
      statusCell.textContent = log.status;
    }
    
    function addLogIngresso(log) {
      const table = document.getElementById("logVendas");
      const row = table.insertRow(0);
      const dataHoraCell = row.insertCell(0);
      const totalCell = row.insertCell(1);
      const destinoCell = row.insertCell(2);
      const statusCell = row.insertCell(3);

      dataHoraCell.textContent = log.dataHora;
      totalCell.textContent = log.total;
      destinoCell.textContent = "Organiza√ß√£o";
      statusCell.textContent = log.status;
    }

    function salvarLog() {
      const total = document.getElementById("total").innerText.replace("Total: R$", "").trim();
      const valorVendedor = document.getElementById("valorVendedor").innerText.replace("Vendedor Recebe (30%): R$", "").trim();
      const status = document.getElementById("parceriaToggle").checked ? "Com Parceria" : "Sem Parceria";
      const dataHora = new Date().toLocaleString();

      const log = { 
        dataHora, 
        total: "R$" + total, 
        destino: "Vendedor: R$" + valorVendedor, 
        status 
      };
      const logs = localStorage.getItem("logs") ? JSON.parse(localStorage.getItem("logs")) : [];
      logs.push(log);
      localStorage.setItem("logs", JSON.stringify(logs));

      addLog(log);
    }
    
    function salvarLogIngressos(total, homens, mulheres) {
      const dataHora = new Date().toLocaleString();
      const status = `Ingressos (H:${homens}, M:${mulheres})`;
      
      const log = { 
        dataHora, 
        total: "R$" + total.toLocaleString("pt-BR", { minimumFractionDigits: 2 }), 
        destino: "Organiza√ß√£o", 
        status 
      };
      
      const logs = localStorage.getItem("logs") ? JSON.parse(localStorage.getItem("logs")) : [];
      logs.push(log);
      localStorage.setItem("logs", JSON.stringify(logs));

      addLogIngresso(log);
    }

    function confirmarLimpeza() {
      const modal = new bootstrap.Modal(document.getElementById("modalConfirmacaoLimpeza"));
      modal.show();
    }

    function limparLogs() {
      localStorage.removeItem("logs");
      document.getElementById("logVendas").innerHTML = "";
      const modal = bootstrap.Modal.getInstance(document.getElementById("modalConfirmacaoLimpeza"));
      modal.hide();
    }

    function exportarXMLSemanal() {
      const logs = localStorage.getItem("logs") ? JSON.parse(localStorage.getItem("logs")) : [];
      
      // Criar array com os √∫ltimos 7 dias
      const diasSemana = [];
      for (let i = 6; i >= 0; i--) {
        const data = new Date();
        data.setDate(data.getDate() - i);
        diasSemana.push(data.toLocaleDateString('pt-BR'));
      }

      // Criar XML
      let xml = '<?xml version="1.0" encoding="UTF-8"?>\n';
      xml += '<relatorio_semanal periodo="' + diasSemana[0] + ' a ' + diasSemana[6] + '">\n';
      
      // Adicionar cabe√ßalho com dias da semana
      xml += '  <dias>\n';
      diasSemana.forEach(dia => {
        xml += '    <dia>' + dia + '</dia>\n';
      });
      xml += '  </dias>\n';
      
      // Adicionar vendas organizadas por dia
      xml += '  <vendas>\n';
      
      diasSemana.forEach(dia => {
        const vendasDia = logs.filter(log => log.dataHora.includes(dia));
        
        xml += '    <venda_dia data="' + dia + '">\n';
        
        if (vendasDia.length === 0) {
          xml += '      <sem_vendas>Nenhuma venda registrada</sem_vendas>\n';
        } else {
          vendasDia.forEach(venda => {
            xml += '      <transacao>\n';
            xml += '        <hora>' + venda.dataHora.split(' ')[1] + '</hora>\n';
            xml += '        <total>' + venda.total + '</total>\n';
            xml += '        <destino>' + venda.destino + '</destino>\n';
            xml += '        <status>' + venda.status + '</status>\n';
            xml += '      </transacao>\n';
          });
        }
        
        xml += '    </venda_dia>\n';
      });
      
      xml += '  </vendas>\n';
      xml += '</relatorio_semanal>';

      // Criar blob e fazer download
      const blob = new Blob([xml], { type: 'application/xml' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'relatorio_semanal_' + new Date().toISOString().split('T')[0] + '.xml';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>